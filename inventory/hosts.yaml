# BRC Analytics Inventory
#
# This inventory is designed for LOCAL execution on each VM.
# The playbook runs on the same machine where ansible-playbook is invoked.
# Use --limit=$(hostname --fqdn) to target the current host.

all:
  vars:
    # Execute locally (no SSH)
    ansible_connection: local
    # Use sudo for privilege escalation
    ansible_become: true

  children:
    production:
      hosts:
        brc-analytics-prod.tacc.utexas.edu:
          brc_environment: production
          brc_domain: platform.brc-analytics.org
          ssl_cert_path: /etc/letsencrypt/live/brc-analytics-prod.tacc.utexas.edu/fullchain.pem
          ssl_key_path: /etc/letsencrypt/live/brc-analytics-prod.tacc.utexas.edu/privkey.pem

    development:
      hosts:
        brc-analytics-dev.tacc.utexas.edu:
          brc_environment: development
          brc_domain: platform-dev.brc-analytics.org
          ssl_cert_path: /etc/letsencrypt/live/brc-analytics-dev.tacc.utexas.edu-0001/fullchain.pem
          ssl_key_path: /etc/letsencrypt/live/brc-analytics-dev.tacc.utexas.edu-0001/privkey.pem

    # Jetstream hosts run multiple environments on a single VM
    # using host-level nginx for SSL/routing
    jetstream:
      hosts:
        brc-backend.novalocal:
          ansible_host: 149.165.172.128
          ssl_cert_email: dannon.baker@gmail.com
          # Skip npm/catalog builds - only running backend containers
          backend_only: true
          # Multiple environments on this host
          brc_environments:
            - name: staging
              domain: platform-staging.brc-analytics.org
              branch: main
              backend_port: 8000
            - name: beta
              domain: platform-beta.brc-analytics.org
              branch: production
              backend_port: 8001
